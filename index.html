<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JamFlow ğŸ¸</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #fff;
      color: #111;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      background: #111;
      padding: 16px 24px;
      display: flex;
      align-items: center;
    }
    header h1 { color: #fff; font-size: 1.4rem; font-weight: 800; letter-spacing: -0.5px; }
    header h1 span { color: #e8003a; }

    .hero {
      width: 100%;
      max-width: 480px;
      padding: 40px 24px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 12px;
    }
    .hero h2 { font-size: 1.6rem; font-weight: 800; line-height: 1.3; }
    .hero h2 span { color: #e8003a; }
    .hero p { font-size: 0.95rem; color: #555; line-height: 1.6; }

    .card {
      width: 100%;
      max-width: 480px;
      background: #fff;
      border: 2px solid #111;
      border-radius: 20px;
      padding: 28px 24px;
      margin: 0 24px 32px;
      box-shadow: 6px 6px 0px #111;
    }
    .card h3 { font-size: 1.05rem; font-weight: 700; margin-bottom: 20px; }

    label {
      display: block;
      font-size: 0.85rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 6px;
    }
    input[type="text"],
    input[type="date"],
    input[type="number"] {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 0.95rem;
      margin-bottom: 4px;
      background: #fafafa;
      transition: border-color 0.2s;
    }
    input:focus {
      outline: none;
      border-color: #e8003a;
      background: #fff;
    }
    .day-label {
      font-size: 0.82rem;
      font-weight: 700;
      color: #e8003a;
      margin-bottom: 14px;
      padding-left: 4px;
      min-height: 18px;
    }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    select {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 0.95rem;
      margin-bottom: 16px;
      background: #fafafa;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23111' stroke-width='2' fill='none'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
    }
    select:focus { outline: none; border-color: #e8003a; }

    .radio-group { display: flex; gap: 10px; margin-bottom: 16px; }
    .radio-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }
    .radio-btn.active { border-color: #e8003a; background: #fff5f7; color: #e8003a; }
    .radio-btn input { display: none; }

    .btn-main {
      width: 100%;
      padding: 16px;
      background: #e8003a;
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 4px 4px 0px #111;
      margin-top: 4px;
      transition: transform 0.15s, box-shadow 0.15s;
    }
    .btn-main:active { transform: translate(2px,2px); box-shadow: 2px 2px 0px #111; }

    .result-box {
      display: none;
      width: 100%;
      max-width: 480px;
      background: #fff5f7;
      border: 2px solid #e8003a;
      border-radius: 20px;
      padding: 24px;
      margin: 0 24px 32px;
      text-align: center;
    }
    .result-box h3 { font-size: 1rem; font-weight: 700; margin-bottom: 12px; }
    .link-box {
      background: #fff;
      border: 2px dashed #e8003a;
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 0.85rem;
      color: #e8003a;
      word-break: break-all;
      margin-bottom: 16px;
      font-family: monospace;
    }
    .btn-copy {
      background: #111;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 12px 24px;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
    }

    .how { width: 100%; max-width: 480px; padding: 0 24px 48px; }
    .how h3 { font-size: 1rem; font-weight: 700; margin-bottom: 16px; }
    .step-item { display: flex; align-items: flex-start; gap: 14px; margin-bottom: 18px; }
    .step-num {
      min-width: 32px; height: 32px;
      background: #e8003a; color: #fff;
      border-radius: 50%; font-size: 0.85rem; font-weight: 800;
      display: flex; align-items: center; justify-content: center;
    }
    .step-text strong { display: block; font-size: 0.9rem; margin-bottom: 2px; }
    .step-text span { font-size: 0.82rem; color: #666; }
  </style>
</head>
<body>

  <header>
    <h1>Jam<span>Flow</span> ğŸ¸</h1>
  </header>

  <section class="hero">
    <div style="font-size:4rem; line-height:1;">ğŸ¸</div>
    <h2>í•©ì£¼ ì‹œê°„,<br/><span>ì´ì œ ì‰½ê²Œ ë§ì¶°ìš”</span> ğŸ¶</h2>
    <p>ë°© ë§Œë“¤ê³  ë§í¬ ê³µìœ í•˜ë©´ ë!<br/>ë¡œê·¸ì¸ ì—†ì´ ëˆ„êµ¬ë‚˜ ì°¸ì—¬í•  ìˆ˜ ìˆì–´ìš”</p>
  </section>

  <div class="card">
    <h3>ğŸ¥ í•©ì£¼ë°© ë§Œë“¤ê¸°</h3>

    <label for="bandName">ë°´ë“œ / ë°© ì´ë¦„</label>
    <input type="text" id="bandName" placeholder="ì˜ˆ: 5ë¶„ì‰¼í‘œ 7ì›” í•©ì£¼" style="margin-bottom:16px;" />

    <label>ë‚ ì§œ ë²”ìœ„ ì„ íƒ</label>
    <div class="row">
      <div>
        <label style="font-size:0.78rem; color:#888;">ì‹œì‘ì¼</label>
        <input type="date" id="startDate" />
        <div class="day-label" id="startDayLabel"></div>
      </div>
      <div>
        <label style="font-size:0.78rem; color:#888;">ì¢…ë£Œì¼</label>
        <input type="date" id="endDate" />
        <div class="day-label" id="endDayLabel"></div>
      </div>
    </div>

    <label>í•©ì£¼ ê°€ëŠ¥ ì‹œê°„ëŒ€</label>
    <div class="row">
      <div>
        <label style="font-size:0.78rem; color:#888;">ì‹œì‘ ì‹œê°„</label>
        <select id="startTime"></select>
      </div>
      <div>
        <label style="font-size:0.78rem; color:#888;">ì¢…ë£Œ ì‹œê°„</label>
        <select id="endTime"></select>
      </div>
    </div>

    <label>ì‹œê°„ ë‹¨ìœ„</label>
    <div class="radio-group">
      <label class="radio-btn active" id="lbl15">
        <input type="radio" name="timeUnit" value="15" checked /> 15ë¶„
      </label>
      <label class="radio-btn" id="lbl30">
        <input type="radio" name="timeUnit" value="30" /> 30ë¶„
      </label>
    </div>

    <label for="memberCount">ì˜ˆìƒ ì¸ì› ìˆ˜</label>
    <input type="number" id="memberCount" placeholder="ì˜ˆ: 4" min="2" max="20" style="margin-bottom:16px;" />

    <button class="btn-main" onclick="createRoom()">ğŸ¸ ë°© ë§Œë“¤ê¸°</button>
  </div>

  <div class="result-box" id="resultBox">
    <h3>ğŸ‰ ë°©ì´ ë§Œë“¤ì–´ì¡Œì–´ìš”!</h3>
    <p style="font-size:0.85rem; color:#555; margin-bottom:12px;">ì•„ë˜ ë§í¬ë¥¼ ë©¤ë²„ë“¤ì—ê²Œ ê³µìœ í•˜ì„¸ìš”</p>
    <div class="link-box" id="shareLink"></div>
    <button class="btn-copy" onclick="copyLink()">ğŸ“‹ ë§í¬ ë³µì‚¬í•˜ê¸°</button>
  </div>

  <div class="how">
    <h3>ğŸ“– ì‚¬ìš© ë°©ë²•</h3>
    <div class="step-item">
      <div class="step-num">1</div>
      <div class="step-text"><strong>ë°© ë§Œë“¤ê¸°</strong><span>ë°´ë“œ ì´ë¦„ê³¼ ë‚ ì§œ ë²”ìœ„ë¥¼ ì…ë ¥í•´ìš”</span></div>
    </div>
    <div class="step-item">
      <div class="step-num">2</div>
      <div class="step-text"><strong>ë§í¬ ê³µìœ </strong><span>ìƒì„±ëœ ë§í¬ë¥¼ ë‹¨í†¡ë°©ì— ë¿Œë ¤ìš”</span></div>
    </div>
    <div class="step-item">
      <div class="step-num">3</div>
      <div class="step-text"><strong>ì‹œê°„ ì²´í¬</strong><span>ê°ì ê°€ëŠ¥í•œ ì‹œê°„ì— ì²´í¬í•´ìš”</span></div>
    </div>
    <div class="step-item">
      <div class="step-num">4</div>
      <div class="step-text"><strong>ë‚ ì§œ í™•ì •!</strong><span>ê²¹ì¹˜ëŠ” ì‹œê°„ì´ ìë™ìœ¼ë¡œ í‘œì‹œë¼ìš”</span></div>
    </div>
  </div>

  <script type="module">
    const DAYS = ['ì¼ìš”ì¼','ì›”ìš”ì¼','í™”ìš”ì¼','ìˆ˜ìš”ì¼','ëª©ìš”ì¼','ê¸ˆìš”ì¼','í† ìš”ì¼'];

    // ë‚ ì§œ ë³€ê²½ ì‹œ ìš”ì¼ í‘œì‹œ
    document.getElementById('startDate').addEventListener('change', function() {
      showDayLabel(this.value, 'startDayLabel');
    });
    document.getElementById('endDate').addEventListener('change', function() {
      showDayLabel(this.value, 'endDayLabel');
    });

    function showDayLabel(val, labelId) {
      const el = document.getElementById(labelId);
      if (!val) { el.textContent = ''; return; }
      const p = val.split('-');
      const d = new Date(parseInt(p[0]), parseInt(p[1])-1, parseInt(p[2]));
      el.textContent = `ğŸ“… ${d.getMonth()+1}ì›” ${d.getDate()}ì¼ ${DAYS[d.getDay()]}`;
    }

    // ê¸°ë³¸ ë‚ ì§œ ì„¸íŒ…
    const today = new Date();
    const pad = n => String(n).padStart(2,'0');
    const todayStr = `${today.getFullYear()}-${pad(today.getMonth()+1)}-${pad(today.getDate())}`;
    const twoWeeks = new Date(today);
    twoWeeks.setDate(today.getDate() + 14);
    const twoWeeksStr = `${twoWeeks.getFullYear()}-${pad(twoWeeks.getMonth()+1)}-${pad(twoWeeks.getDate())}`;

    document.getElementById('startDate').value = todayStr;
    showDayLabel(todayStr, 'startDayLabel');
    document.getElementById('endDate').value = twoWeeksStr;
    showDayLabel(twoWeeksStr, 'endDayLabel');

    // ì‹œê°„ ì˜µì…˜ ìƒì„±
    function buildTimeOptions() {
      const s = document.getElementById('startTime');
      const e = document.getElementById('endTime');
      for (let h = 0; h <= 24; h++) {
        const label = h === 0   ? 'ì˜¤ì „ 12ì‹œ'
                    : h < 12   ? `ì˜¤ì „ ${h}ì‹œ`
                    : h === 12 ? 'ì˜¤í›„ 12ì‹œ'
                    : h < 24   ? `ì˜¤í›„ ${h-12}ì‹œ`
                    :             'ìì • 12ì‹œ';
        s.add(new Option(label, h));
        e.add(new Option(label, h));
      }
      s.value = 9;
      e.value = 22;
    }
    buildTimeOptions();

    // ë¼ë””ì˜¤ ë²„íŠ¼
    document.querySelectorAll('input[name="timeUnit"]').forEach(radio => {
      radio.addEventListener('change', function() {
        document.querySelectorAll('.radio-btn').forEach(l => l.classList.remove('active'));
        this.closest('.radio-btn').classList.add('active');
      });
    });

    // ë°© ë§Œë“¤ê¸°
    function createRoom() {
      const name      = document.getElementById('bandName').value.trim();
      const start     = document.getElementById('startDate').value;
      const end       = document.getElementById('endDate').value;
      const startTime = document.getElementById('startTime').value;
      const endTime   = document.getElementById('endTime').value;
      const unit      = document.querySelector('input[name="timeUnit"]:checked').value;
      const count     = document.getElementById('memberCount').value;

      if (!name)  { alert('ë°´ë“œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ¸'); return; }
      if (!start || !end) { alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ“…'); return; }
      if (new Date(start) > new Date(end)) { alert('ì‹œì‘ì¼ì´ ì¢…ë£Œì¼ë³´ë‹¤ ëŠ¦ì–´ìš”!'); return; }
      if (parseInt(startTime) >= parseInt(endTime)) { alert('ì¢…ë£Œ ì‹œê°„ì´ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ëŠ¦ì–´ì•¼ í•´ìš”!'); return; }
      if (!count) { alert('ì¸ì› ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!'); return; }

      const roomId = 'room_' + Math.random().toString(36).substr(2, 8);
      // Firebaseì— ë°© ì •ë³´ ì €ì¥
      if (db) {
        set(ref(db, `rooms/${roomId}/info`), {
          name, start, end, startTime, endTime, unit, members: count
        });
      }

      const params = new URLSearchParams({ id: roomId, name, start, end, startTime, endTime, unit, members: count });
      const link = `${window.location.origin}/room.html?${params.toString()}`;

      document.getElementById('shareLink').textContent = link;
      document.getElementById('resultBox').style.display = 'block';
      document.getElementById('resultBox').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // ë§í¬ ë³µì‚¬
    function copyLink() {
      const link = document.getElementById('shareLink').textContent;
      navigator.clipboard.writeText(link).then(() => {
        alert('âœ… ë§í¬ê°€ ë³µì‚¬ëì–´ìš”! ë©¤ë²„ë“¤ì—ê²Œ ê³µìœ í•˜ì„¸ìš” ğŸ¶');
      }).catch(() => {
        const el = document.createElement('textarea');
        el.value = link;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert('âœ… ë§í¬ê°€ ë³µì‚¬ëì–´ìš”!');
      });
    }
  </script>
</body>
</html>
